# CoolWeather - 全国天气应用

学习书籍《第一行代码》时写的demo，这是一个完整的Android天气应用项目，实现了从省份到城市再到区县的层级选择，以及详细的天气信息展示功能。应用采用现代化的Android开发技术栈，具有良好的用户体验和稳定的性能表现。

## 核心功能

### 🌍 地区选择功能
- **三级地区选择**：省份 → 城市 → 区县
- **智能缓存机制**：首次查询从API获取数据并存储到本地数据库
- **离线查询**：再次查询相同地区时直接从本地数据库读取
- **流畅导航**：支持前进和后退操作

### 🌤️ 天气信息展示
- **实时天气**：当前温度、天气状况、风力信息
- **未来预报**：多天天气预报，包含温度、天气、风力
- **生活指数**：穿衣建议、洗车指数、旅游指数、舒适度等
- **数据缓存**：支持天气数据本地缓存，提升用户体验

## 技术架构

### 📱 开发环境
- **Android SDK**：API 26-28 (Android 8.0-9.0)
- **开发工具**：Android Studio
- **构建工具**：Gradle 2.3.3
- **最低支持**：Android 8.0 (API 26)

### 🏗️ 项目结构
```
app/src/main/java/com/example/one/coolweather/
├── MainActivity.java              # 主活动，承载地区选择Fragment
├── WeatherActivity.java           # 天气展示活动
├── ChooseAreaFragment.java        # 地区选择Fragment
├── db/                           # 数据库模型
│   ├── Province.java             # 省份实体
│   ├── City.java                 # 城市实体
│   └── District.java             # 区县实体
├── gson/                         # JSON数据模型
│   ├── Weather.java              # 天气主实体
│   ├── Today.java                # 今日天气
│   ├── Future.java               # 未来天气
│   └── Sk.java                   # 实时天气信息
└── util/                         # 工具类
    ├── HttpUtil.java             # 网络请求工具
    ├── ApiUtil.java              # API配置
    └── Utility.java              # 数据解析工具
```

### 🛠️ 核心技术栈

#### 数据存储
- **LitePal**：轻量级ORM框架，简化SQLite操作
- **SharedPreferences**：天气数据缓存存储
- **数据库设计**：省市区三级关联表结构

#### 网络通信
- **OkHttp 3.6.0**：现代化HTTP客户端
- **异步请求**：非阻塞网络操作
- **超时控制**：连接超时10分钟，读取超时20分钟

#### 数据解析
- **Gson 2.7**：JSON数据序列化/反序列化
- **FastJSON 1.2.54**：阿里巴巴JSON处理库
- **JSONObject**：Android原生JSON解析

#### 图像处理
- **Glide 3.7.0**：图片加载和缓存框架

### 🎨 用户界面

#### 布局设计
- **Fragment架构**：模块化UI组件
- **响应式布局**：适配不同屏幕尺寸
- **Material Design**：现代化UI设计风格

#### 主要界面
1. **地区选择界面** (`choose_area.xml`)
   - 标题栏显示当前选择级别
   - 列表视图展示地区选项
   - 返回按钮支持层级导航

2. **天气展示界面** (`activity_weather.xml`)
   - 滚动视图支持内容滚动
   - 模块化布局：标题、当前天气、预报、建议
   - 渐变背景提升视觉效果

3. **天气信息模块**
   - **当前天气** (`now.xml`)：温度、天气状况
   - **未来预报** (`forecast.xml`)：多天天气预报
   - **生活建议** (`suggestion.xml`)：各种生活指数

### 🔌 API集成

#### 天气数据源
- **聚合数据API**：提供全国天气信息
- **API地址**：`https://v.juhe.cn/weather/`
- **数据格式**：JSON格式返回
- **功能接口**：
  - 城市列表查询：`/weather/citys`
  - 天气信息查询：`/weather/index`

#### 数据流程
1. **地区数据获取**：从API获取省市区数据并存储到本地数据库
2. **天气数据查询**：根据选择的区县查询具体天气信息
3. **数据缓存机制**：本地存储减少网络请求，提升响应速度

### 📊 数据模型

#### 地区数据模型
- **Province**：省份信息（ID、省份名称）
- **City**：城市信息（ID、城市名称、所属省份ID）
- **District**：区县信息（ID、区县名称、所属城市ID）

#### 天气数据模型
- **Weather**：天气主实体，包含实时天气、今日天气、未来预报
- **Today**：今日天气详情，包含温度、天气、各种生活指数
- **Future**：未来天气预报，包含多天天气信息
- **Sk**：实时天气信息，包含当前温度、风力、湿度等

### ⚡ 性能优化

#### 缓存策略
- **地区数据缓存**：首次查询后存储到本地数据库
- **天气数据缓存**：使用SharedPreferences缓存天气信息
- **智能更新**：仅在地区变更时重新请求天气数据

#### 网络优化
- **异步请求**：避免阻塞主线程
- **超时控制**：合理的网络超时设置
- **错误处理**：完善的网络异常处理机制

## 运行效果

### 天气显示界面
- 清晰的当前天气信息展示
- 直观的未来天气预报
- 实用的生活建议信息

### 地区选择界面
- 流畅的三级地区选择体验
- 直观的导航和返回操作
- 快速的数据加载和显示

## 项目特色

1. **完整的Android应用架构**：遵循Android开发最佳实践
2. **智能数据缓存**：减少网络请求，提升用户体验
3. **模块化设计**：清晰的代码结构和职责分离
4. **用户友好界面**：直观的操作流程和美观的界面设计
5. **稳定的网络处理**：完善的异常处理和超时控制

## 技术亮点

- **LitePal ORM**：简化数据库操作，提高开发效率
- **Fragment架构**：模块化UI设计，便于维护和扩展
- **异步网络请求**：保证UI响应流畅
- **数据缓存机制**：优化用户体验和网络使用
- **JSON数据解析**：灵活处理复杂的API响应数据


